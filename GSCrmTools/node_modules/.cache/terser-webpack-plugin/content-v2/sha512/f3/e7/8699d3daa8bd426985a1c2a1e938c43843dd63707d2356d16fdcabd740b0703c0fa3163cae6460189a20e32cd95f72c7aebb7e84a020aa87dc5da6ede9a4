{"code":"!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\",a(a.s=0)}([function(e,t,a){\"use strict\";a.r(t);class n{RenderBrand(){$('[data-type=\"Navbar\"]').addClass(\"gs-navbar row\").append('<div class=\"gs-nav-brand\"><p style=\"line-height: 50px\" class=\"label-md\">GSCrm</p></div><div class=\"gs-nav-toggler\" data-type=\"NavbarToggler\" collapsed=\"false\"><a class=\"icon-menu\"></a></div><div class=\"gs-nav-toggler-brand\" data-type=\"NavbarToggler\" style=\"display: none\" collapsed=\"false\"><h4>Screens</h4></div>')}RenderNavbar(e,t,a,n){let o=$('[data-type=\"Navbar\"]');return o.empty().addClass(\"gs-navbar row\").append('<div class=\"gs-nav-brand\"><p style=\"line-height: 50px\" class=\"label-md\">GSCrm</p></div><div class=\"gs-nav-toggler\" data-type=\"NavbarToggler\"><a class=\"icon-menu\"></a></div><div class=\"gs-nav-toggler-brand\" data-type=\"NavbarToggler\"><h4>Screens</h4></div></div><div class=\"gs-nav-area\" style=\"display: none\"><div style=\"margin-top: 10px\" class=\"row gs-nav-area-header\"><p class=\"label-lg\">Screens</p></div><div class=\"divider-mr-md\"></div><div class=\"row gs-nav-area-body\"></div></div>'),t.forEach(e=>{let t='<div class=\"col-md-4 col-lg-3 gs-nav-item\" data-type=\"ScreenMenuItem\" data-name=\"'+e.Name+'\"><div class=\"gs-nav-link row\"><div class=\"col\"><p>'+e.Header+'</p><p></p></div><div class=\"expand-items col-auto\"><span class=\"icon-stack expand-icon\"></span></div></div></div>';e.Name==a.Name&&(t='<div disabled class=\"col-md-4 col-lg-3 gs-nav-item-static\" data-type=\"ScreenMenuItem\" data-name=\"'+e.Name+'\"><div class=\"gs-nav-link row\"><div class=\"col\"><p>'+e.Header+'</p><p></p></div><div class=\"expand-items col-auto\"><span class=\"icon-stack expand-icon\"></span></div></div></div>'),$(o).find(\".gs-nav-area > .row\").last().append(t),$(\".gs-nav-link .col\").off(\"click\").on(\"click\",e=>{$(o).trigger(\"SelectScreenMenuItem\",{Event:e,Screen:$(e.currentTarget).closest('[data-type=\"ScreenMenuItem\"]').attr(\"data-name\"),View:null})})}),$(\".gs-nav-toggler-brand\").css(\"display\",\"block\"),o.find(\".expand-items\").off(\"click\").on(\"click\",e=>{new GSCrmInfo.Application.Screen($(e.currentTarget).closest('[data-type=\"ScreenMenuItem\"]').attr(\"data-name\")).RequestInfo().catch(e=>console.log(e)).then(e=>{$(\".gs-nav-area\").empty().append('<div class=\"row gs-nav-area-header\"><div class=\"hide-items col-auto\"><span class=\"hide-icon icon-long-arrow-left\"></span></div><div style=\"margin-top: 5px\" class=\"col\"><p class=\"label-lg\">Screen views</p></div><div style=\"visibility: hidden\" class=\"hide-items col-auto\"><span class=\"hide-icon icon-long-arrow-left\"></span></div></div><div style=\"background-color: black\" class=\"divider-mr-none\"></div><div class=\"row\"></div>').off(\"click\",\".hide-items\").on(\"click\",\".hide-items\",e=>this.RenderNavbar(e,t,a,!1));let n=e.AllCategoriesViews;for(let t in n){let a=$('<div class=\"col\"><div style=\"margin-top: 10px; margin-bottom: 10px\" class=\"row gs-nav-area-header\"><p class=\"label-md\">'+t+'</p></div><div class=\"divider-mr-md\"></div><div class=\"row gs-nav-area-body\"></div></div>');n[t].forEach(t=>{let n=$('<div class=\"col-md-4 col-lg-3\" data-type=\"ScreenItem\" data-name=\"'+t.Name+'\"><div class=\"gs-nav-link-short row\"><div class=\"col\"><p>'+t.Header+\"</p><p></p></div></div>\");t.Name==GSCrmInfo.CurrentElementsInfo.View.Name&&t.Name==e.CurrentView.Name?$(n).addClass(\"gs-nav-item-static\"):$(n).addClass(\"gs-nav-item\"),$(n).off(\"click\").on(\"click\",t=>{$(o).trigger(\"SelectScreenItem\",{Event:t,Screen:e.Name,View:$(t.currentTarget).attr(\"data-name\")})}),$(a).find(\".gs-nav-area-body\").last().append(n)}),$(\".gs-nav-area > .row\").last().append(a)}})}),o.find(\".gs-nav-area\").off(\"click\").on(\"click\",e=>e.stopPropagation()),n?o.find(\".gs-nav-area\").slideDown(\"fast\"):(o.find(\".gs-nav-toggler\").attr(\"collapsed\",!0),o.find(\".gs-nav-toggler-brand\").attr(\"collapsed\",!0),o.find(\".gs-nav-area\").css(\"display\",\"block\")),o}DisposeNavbar(){let e=$(\".gs-nav-area\");return $(\".gs-nav-toggler-brand\").css(\"display\",\"none\"),e.slideUp(\"fast\").empty(),e}HideNavbar(){let e=$(\".gs-nav-area\");return $(\".gs-nav-toggler-brand\").css(\"display\",\"none\"),e.css(\"display\",\"none\"),e}}class o{RenderApplication(){if($('[data-type=\"GSCrmBody\"]').hasClass(\"large-container\")||$('[data-type=\"GSCrmBody\"]').addClass(\"large-container\"),0==$(\".gs-header\").length&&$('[data-type=\"GSCrmHeader\"]').append('<div class=\"gs-header\"></div>'),0==$('[data-type=\"MaskArea\"]').length&&$('[data-type=\"GSCrmAreas\"]').append('<div data-type=\"MaskArea\" class=\"mask-all-screen d-none\"></div>'),0==$('[data-type=\"SelectArea\"]').length&&$('[data-type=\"GSCrmAreas\"]').append('<div data-type=\"SelectArea\" class=\"select-area d-none\"></div>'),0==$('[data-type=\"PopupArea\"]').length&&$('[data-type=\"GSCrmAreas\"]').append('<div data-type=\"PopupArea\" class=\"all-popup d-none\"></div>'),0==$('[data-type=\"ExpectationArea\"]').length&&$('[data-type=\"GSCrmAreas\"]').append('<div data-type=\"ExpectationArea\" class=\"cssload-wrapper d-none\"><div class=\"cssload-loader\"><div class=\"cssload-inner cssload-one\"></div><div class=\"cssload-inner cssload-two\"></div><div class=\"cssload-inner cssload-three\"></div></div></div>'),0==$('[data-type=\"Navbar\"]').length){$(\".gs-header\").append('<div class=\"border-bottom box-shadow mb-3\"><div data-type=\"Navbar\"></div></div>'),(new n).RenderBrand()}}CloseSelectArea(){let e=$(\"#\"+$('[data-type=\"SelectArea\"]').attr(\"data-target-id\"));e.removeClass(\"gs-field-is-focused\"),\"\"!=e.find(\".gs-field-input\").val()?e.addClass(\"gs-field-is-filled\"):e.removeClass(\"gs-field-is-filled\"),$('[data-type=\"SelectArea\"]').addClass(\"d-none\").removeAttr(\"style\").removeAttr(\"data-target-id\").empty(),$(\".pick-area\").find(\".icon-chevron-thin-left\").removeClass(\"icon-chevron-thin-left\").addClass(\"icon-chevron-thin-right\"),$(\".pick-area\").css(\"color\",\"lightgrey\")}}class i{static Invoke(e,t,a,n){return(new{Navigation:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo,n=a.View,o=a.TargetApplet,i=a.ControlName,l=o.GetSelectedRecordProperty(\"Id\"),r={ViewName:n.GetName(),CurrentApplet:o.GetName(),CurrentRecord:l,CurrentControl:i,Action:i};n.UpdateViewInfo(r).catch(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t(e)}).then(()=>{o.Initialize().catch(e=>t(e)).then(()=>{l=o.GetSelectedRecordProperty(\"Id\"),n.PartialUpdateContext(o.GetInfo(),l,!1).catch(e=>t(e)).then(()=>{e()}).finally(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})})})}},ShowPopup:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((t,a)=>{e.stopPropagation();let n=GSCrmInfo.CurrentElementsInfo,o=n.View,i=n.TargetApplet,l=n.ControlName,r=n.Record,s=null==r?null:r.Id,d=i.GetInfo().ControlUPs[l].filter(e=>\"Applet\"==e.Name)[0].Value,p=i.GetInfo().AppletId+\"_Popup_0\",c=0;for(;$(\"#\"+p).length>0;)p=p.split(c).join(c+1),c++;let m={ViewName:o.Name,CurrentApplet:i.GetName(),CurrentRecord:s,CurrentControl:l,OpenPopup:!0,Action:\"ShowPopup\"};o.UpdateViewInfo(m).catch(e=>a(e)).then(()=>{let n=new GSCrmInfo.Application.PopupApplet(d,p);GSCrmInfo.SetElement(\"PopupApplet\",n),n.Initialize(e).catch(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),a(e)}).then(()=>t()).finally(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})})}},NewRecord:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,a)=>{let n,o=GSCrmInfo.CurrentElementsInfo,i=o.View,l=o.TargetApplet,r=o.PopupApplet;n=null==r||null==r?l:r,GSCrmInfo.Application.CommonRequests.NewRecord(n,t).fail(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),a(e.responseJSON)}).done(t=>{Object.is(r,null)?i.PartialUpdateContext(l,t.Id,!0).catch(e=>a(e)).then(()=>e()).finally(()=>{GSCrmInfo.SetElement(\"Record\",t),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")}):GSCrmInfo.Application.CommonAction.DisposePopupApplet(\"NewRecord\",t,o.ControlName).catch(e=>a(e)).then(()=>{i.PartialUpdateContext(l,t.Id,!0).catch(e=>a(e)).then(()=>e()).finally(()=>{GSCrmInfo.SetElement(\"Record\",t),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})})})}},UndoRecord:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo,n=a.PopupApplet;null!=n&&null!=n&&GSCrmInfo.Application.CommonAction.DisposePopupApplet(\"UndoRecord\",a.Record,a.ControlName).catch(e=>t(e)).then(()=>e()).finally(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})}},UpdateRecord:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,a)=>{let n,o=GSCrmInfo.CurrentElementsInfo,i=o.View,l=o.TargetApplet;n=null==popupApplet||null==popupApplet?l:popupApplet,GSCrmInfo.Application.CommonRequests.UpdateRecord(n,t).fail(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),a(e)}).done(t=>{GSCrmInfo.Application.CommonAction.DisposePopupApplet(\"UpdateRecord\",t,o.ControlName).catch(e=>a(e)).then(()=>i.PartialUpdateContext(l,t.Id,!0).catch(e=>a(e)).then(()=>{e()}).finally(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")}))})})}},AutoUpdateRecord:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo,n=a.RecordToUpdate,o=a.AppletToUpdate,i=a.View;GSCrmInfo.Application.CommonRequests.UpdateRecord(o,n).fail(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t(e)}).done(t=>{GSCrmInfo.SetElement(\"AppletToUpdate\",null),GSCrmInfo.SetElement(\"UpdateRecordSet\",!1),GSCrmInfo.SetElement(\"RecordToUpdate\",null),i.RefreshAppletUI(o,t),e()})})}},UndoUpdate:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo,n=a.Record,o=a.PopupApplet;null!=o&&null!=o&&GSCrmInfo.Application.CommonAction.DisposePopupApplet(\"UndoUpdate\",n,a.ControlName).catch(e=>t(e)).then(()=>e()).finally(()=>{a.View.RefreshAppletUI(a.TargetApplet,n),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})}},DeleteRecord:class extends GSCrmInfo.Application.CommonAction{Initialize(e,t){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo,n=a.View,o=a.TargetApplet,i=a.Record.Id,l=a.ControlName,r={id:i,appletName:o.GetName()};GSCrmInfo.Application.CommonRequests.DeleteRecord(o,r).fail(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t(e.responseJSON)}).done(a=>{i=null==a?null:a.Id,r={ViewName:n.GetName(),CurrentApplet:o.GetName(),CurrentRecord:i,CurrentControl:l,Action:\"DeleteRecord\"},n.UpdateViewInfo(r).catch(e=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t(e)}).then(()=>{n.PartialUpdateContext(o,i,!0).catch(e=>t(e)).then(()=>e()).finally(()=>{GSCrmInfo.SetElement(\"Record\",a),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\")})})})})}},ApplyTable:class extends GSCrmInfo.Application.CommonAction{Initialize(){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo.TargetApplet;GSCrmInfo.Application.CommonRequests.ApplyTable(a).fail(e=>t(e)).done(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),e()})})}},GenerateCode:class extends GSCrmInfo.Application.CommonAction{Initialize(){return new Promise((e,t)=>{let a=GSCrmInfo.CurrentElementsInfo.TargetApplet;GSCrmInfo.Application.CommonRequests.GenerateCode(a).fail(e=>t(e)).done(()=>{$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),e()})})}}}[e]).Initialize(t,a,n)}static DisposePopupApplet(e,t,a){return new Promise((n,o)=>{let i=GSCrmInfo.CurrentElementsInfo,l=i.PopupApplet;if(!Object.is(l,null)){l.Dispose();let r=i.View,s={ViewName:r.GetName(),CurrentApplet:i.TargetApplet.GetName(),CurrentRecord:null==t?null:t.Id,ClosePopup:!0,CurrentPopupControl:a,Action:e};r.UpdateViewInfo(s).catch(e=>o(e)).then(()=>n())}})}}var l=new Map,r=function(){let e=function(e,t){let a;this.Name=e,this.Id=t,this.Name=null==e?function(){let e;return GSCrmInfo.AppletsInfo.forEach((a,n)=>{a.AppletId==t&&(e=n)}),e}():e,this.Id=null==t?function(){let t;return GSCrmInfo.AppletsInfo.forEach((a,n)=>{n==e&&(t=a.AppletId)}),t}():t,GSCrmInfo.ViewsInfo.forEach((e,t)=>{e.ViewItems.forEach(e=>{e.AppletName==this.Name&&(a=t)})}),this.Info=GSCrmInfo.GetAppletInfo(this.Name),null!=this.Info&&null!=a&&(this.Info.View=a)};return e.prototype.GetId=function(){return this.Id},e.prototype.GetName=function(){return this.Name},e.prototype.GetInfo=function(){return this.Info},e.prototype.InitializeApplet=function(){return new Promise((e,t)=>{null==GSCrmInfo.GetAppletInfo(this.Name)?GSCrmInfo.Application.CommonRequests.InitializeApplet(this.Name).fail(e=>t(e)).done(t=>{t.AppletId=this.Id,t.TileItems=[],GSCrmInfo.RemoveOldAppletInfo(this.Name),GSCrmInfo.SetAppletInfo(this.Name,t),this.Info=t,e(t)}):(this.Info.AppletId=this.Id,e())})},e.prototype.InitializeControls=function(){$(\"#\"+this.Info.AppletId)[0].querySelectorAll('[data-type=\"control\"]').forEach(e=>{let t=$(e).attr(\"data-name\"),a=0,n=\"control_\"+t+\"_\"+a;for(;$(\"#\"+n).length>0;)n=n.split(a).join(a+1),a++;$(e).attr(\"id\",n),new GSCrmInfo.Application.Control(this,t,n).Initialize(this)})},e.prototype.GetCurrentControl=function(e){return $(e.currentTarget).closest('[data-type=\"control\"]')},e.prototype.GetControlsProperty=function(e){return this.Info.Controls.map(t=>t[e])},e.prototype.GetControlProperties=function(e){return this.Info.Controls.filter(t=>t.Name==e)[0]},e.prototype.GetControlsByPropertyValue=function(){return this.Info.Controls.filter(e=>e[popertyName]==popertyValue)[0]},e.prototype.GetControlUPs=function(e){return this.Info.ControlUPs},e.prototype.GetRecordSet=function(){return l.get(this.Name)},e.prototype.SetRecordSet=function(e){l.set(this.Name,e)},e.prototype.DeleteRecordSet=function(){l.delete(this.Name)},e.prototype.GetAppletRecord=function(){return new Promise((e,t)=>{GSCrmInfo.Application.CommonRequests.GetRecord(this.Info).fail(e=>t(e)).done(t=>e(t))})},e.prototype.GetRecordsProperty=function(e){return this.GetRecordSet().map(t=>t[e])},e.prototype.GetRecordByProperty=function(e,t){return this.GetRecordSet().filter(a=>a[e]==t)},e.prototype.UpdateRecordInRS=function(e,t,a){switch(this.Info.Type){case\"Tile\":this.SetRecordSet(this.GetRecordSet().map(n=>(n[t]==a&&(n=e),n)));break;case\"Form\":this.SetRecordSet(e)}},e.prototype.IsSystemAction=function(e){return-1!=[\"NextRecords\",\"PreviousRecords\",\"ShowPopup\",\"NewRecord\",\"UpdateRecord\",\"DeleteRecord\",\"UndoRecord\",\"UndoUpdate\",\"AppletConfg\"].indexOf(e)},e.prototype.InvokeAction=function(e,t){let a;a=\"NextRecords\"==t.ActionName||\"PreviousRecords\"==t.ActionName?\"Navigation\":t.ActionName,GSCrmInfo.SetUpCurrentElements(e);let n=GSCrmInfo.Application.CommonAction.Invoke(a,e,this.GetRecordSet());null!=n?null!=n&&n.catch(e=>{console.log(e)}).then().finally(()=>{$('[data-type=\"control\"]').attr(\"disabled\",!1),$('[data-type=\"applet_item\"]').attr(\"disabled\",!1)}):($('[data-type=\"control\"]').attr(\"disabled\",!1),$('[data-type=\"applet_item\"]').attr(\"disabled\",!1))},e}();class s{get SelectedMonth(){return this.selectedMonth}set SelectedMonth(e){this.selectedMonth=e}get SelectedYear(){return this.selectedYear}set SelectedYear(e){this.selectedYear=e}get SelectedDay(){return this.selectedDay}set SelectedDay(e){this.selectedDay=e}get Field(){return this.field}set Field(e){this.field=e}get DateIsSelected(){return this.dateIsSelected}set DateIsSelected(e){this.dateIsSelected=e}Initialize(e,t){var a=new Date,n=$(e).find(\".gs-field-input\").val();this.Field=e,\"\"===n&&(this.SelectedDay=a.getDate(),this.SelectedMonth=a.getMonth(),this.SelectedYear=a.getFullYear()),\"\"!==n&&(this.SelectedDay=n.split(\" \")[0],this.SelectedMonth=GetMonthIndex(n.split(\" \")[1],\"long\"),this.SelectedYear=n.split(\" \")[2],this.DateIsSelected=!0),this.FillCalendar(),this.SetStyle(),this.SetLocation(t),$('[data-type=\"SelectArea\"]').off(\"click\",\".month-day\").off(\"click\",\"#nextMonth\").off(\"click\",\"#previousMonth\").off(\"click\",\"#nextYear\").off(\"click\",\"#previousYear\").off(\"click\",\"#selectedYear\").off(\"click\",\"#choiseDay\").off(\"click\",\".square-tile-item\").off(\"click\",\"#currentDate\").on(\"click\",\".month-day\",e=>{let t=e.currentTarget;this.DateIsSelected=!0,$(\".month-day\").removeClass(\"month-day-focused\"),$(t).addClass(\"month-day-focused\"),this.SelectedDay=$(t)[0].innerText,$(\"#\"+$('[data-type=\"SelectArea\"]').attr(\"data-target-id\")).find(\".gs-field-input\").val(this.SelectedDay+\" \"+this.GetMonthName(this.SelectedMonth,\"long\")+\" \"+this.SelectedYear)}).on(\"click\",\"#nextMonth\",e=>{e.stopPropagation(),this.SelectedMonth=this.SelectedYear+1,12==this.SelectedMonth&&(this.SelectedMonth=0,this.SelectedYear=this.SelectedYear+1),this.SelectMonthYear()}).on(\"click\",\"#previousMonth\",e=>{e.stopPropagation(),this.SelectedMonth=this.SelectedYear-1,-1==this.SelectedMonth&&(this.SelectedMonth=11,this.SelectedYear=this.SelectedYear-1),this.SelectMonthYear()}).on(\"click\",\"#nextYear\",e=>{e.stopPropagation(),this.SelectedYear=this.SelectedYear+1,this.SelectMonthYear()}).on(\"click\",\"#previousYear\",e=>{e.stopPropagation(),this.SelectedYear=this.SelectedYear-1,this.SelectMonthYear()}).on(\"click\",\"#selectedMonth\",e=>{e.stopPropagation();let t=$('<div class=\"row no-gutters justify-content-center\" style=\"height: 40px\"><div class=\"light-green-btn\" id=\"choiseDay\"><div class=\"block-center\"><p>Choise day</p></div></div></div>'),n=$('<div class=\"popup-tile-container\"><div class=\"row no-gutters justify-content-between square-tile\"></div></div>');this.GetMonthList(\"short\").forEach((e,t,a)=>{n.find(\".square-tile\").append('<div class=\"col\"><div class=\"square-tile-item\" id=\"all_month_list_item_'+t+'\"><p>'+e+\"</p></div></div>\")}),$(\".calendar-mini\").empty().append(t).append('<div class=\"divider-mr-md\"></div>').append(n),$(\"#all_month_list_item_\"+this.SelectedMonth).css(\"border\",\"2px solid #2ecc71\").css(\"border-radius\",\"50%\"),$(\"#all_month_list_item_\"+a.getMonth()).css(\"border\",\"2px solid #2980b9\").css(\"border-radius\",\"50%\"),this.SetLocation(e)}).on(\"click\",\".square-tile-item\",e=>{let t=e.currentTarget;e.stopPropagation();let a=$(t).attr(\"id\").split(\"all_month_list_item_\")[1],n=$(t).attr(\"id\").split(\"all_year_list_item_\")[1];void 0!==a&&(this.SelectedMonth=a),void 0!==n&&(this.SelectedMonth=n),this.SelectMonthYear()}).on(\"click\",\"#choiseDay\",e=>{e.stopPropagation(),this.SelectMonthYear()}).on(\"click\",\"#currentDate\",e=>{e.stopPropagation(),this.DateIsSelected=!0,this.SelectedDay=a.getDate(),this.SelectedMonth=a.getMonth(),this.SelectedYear=a.getFullYear(),this.SelectMonthYear()})}SelectMonthYear(){this.GetDaysInMonth(this.SelectedMonth,this.SelectedYear)<this.SelectedDay&&(this.SelectedDay=this.GetDaysInMonth(this.SelectedMonth,this.SelectedYear)),this.FillCalendar(),this.SetStyle(),this.SetLocation(),$(\"#\"+$('[data-type=\"SelectArea\"]').attr(\"data-target-id\")).find(\".gs-field-input\").val(this.SelectedDay+\" \"+this.GetMonthName(this.SelectedMonth,\"long\")+\" \"+this.SelectedYear)}FillCalendar(){let e=$('<div class=\"row no-gutters justify-content-around days-list\"></div>');[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"].forEach((t,a)=>{e.last(\"div\").append('<div class=\"col\" id=\"day_'+(a+1)+'\"><div class=\"block-center\"><p>'+t+\"</div>\")}),$('[data-type=\"SelectArea\"]').empty().append(this.GetMonthYearList()).removeClass(\"d-none\").find(\".calendar-mini\").append('<div class=\"divider-mr-md\" style=\"background-color: grey\"></div>').append(e).append('<div class=\"divider-mr-md\" style=\"background-color: grey\"></div>').append(this.GetMonthDays())}SetStyle(){var e=new Date;$('[data-type=\"SelectArea\"]').attr(\"data-target-id\",$(this.Field).attr(\"id\")),$(\".field-date\").removeClass(\"gs-field-is-focused\"),this.SelectedMonth==e.getMonth()&&this.SelectedYear==e.getFullYear()&&$(\".month-day\").filter((t,a)=>{a.textContent==e.getDate()&&$(a).addClass(\"current-day\")}),this.DateIsSelected&&$(\".month-day\").filter((e,t)=>{t.textContent==this.SelectedDay&&$(t).addClass(\"month-day-focused\")}),$(\".month-day\").each((e,t)=>{this.isHoliday(e)&&$(t).addClass(\"holiday-day\")}),$(this.Field).addClass(\"gs-field-is-focused\").find(\".gs-field-input\").focus()}SetLocation(e){if($('[data-type=\"SelectArea\"]').attr(\"style\",\"\"),0!==$(e.currentTarget).closest('[data-type=\"PopupArea\"]').length){var t=$('[data-type=\"SelectArea\"]').find(\".calendar-mini\").height(),a=this.Field.offsetWidth,n=this.Field.offsetHeight,o=window.innerWidth,i=window.innerHeight,l=$(this.Field).closest(\".popup-wrap\").width(),r=$(this.Field).closest(\".popup-wrap\").height(),s=$(this.Field).offset().left-1,d=$(this.Field).offset().top,p=$(\".p-modal-head\").offset().top,c=$(\".p-modal-body\").offset().left,m=d-p,f=s-c,u=r-(m+n),h=l-(f+a);u<t&&(d=m+p-t-n),m<t+n&&(d=(i-r)/2+m+n),h<400&&($('[data-type=\"SelectArea\"]')[0].style.left=c+f+a-400+\"px\"),f<400&&($('[data-type=\"SelectArea\"]')[0].style.left=s+\"px\"),u<t&&m<t+n&&(d=(i-t)/2,$('[data-type=\"SelectArea\"]')[0].style.left=f<400?s+a+\"px\":s-400+\"px\"),h<400&&f<400&&($('[data-type=\"SelectArea\"]')[0].style.left=(o-400)/2+\"px\"),$('[data-type=\"SelectArea\"]')[0].style.top=d+\"px\",$('[data-type=\"SelectArea\"]')[0].style.position=\"fixed\"}else{s=$(this.Field).offset().left-1,d=$(this.Field).offset().top;var S=$(document).width();$(document).height()-(t=$('[data-type=\"SelectArea\"]').find(\".calendar-mini\").height())<d?d=d-t-21:d+=46,$('[data-type=\"SelectArea\"]')[0].style.top=d+\"px\",S-400<s?(s-=400,$('[data-type=\"SelectArea\"]')[0].style.right=S-(s+this.Field.offsetWidth)+\"px\"):$('[data-type=\"SelectArea\"]')[0].style.left=s+\"px\"}}GetMonthYearList(){return'<div class=\"calendar-mini\"><div class=\"row no-gutters justify-content-between\" style=\"height: 40px\"><div class=\"row no-gutters justify-content-around\" style=\"height: 100%\"><div class=\"arr-previous-md\" style=\"color: lightgrey\" id=\"previousYear\"><span class=\"icon-chevron-thin-left\"></span></div><div style=\"height: 100%\"><h5 class=\"label-think-md\" id=\"selectedYear\">'+this.SelectedYear+'</h5></div><div class=\"arr-next-md\" style=\"color: lightgrey\" id=\"nextYear\"><span class=\"icon-chevron-thin-right\"></span></div></div><div class=\"blue-btn\" id=\"currentDate\"><div class=\"block-center\"><p>Now</p></div></div><div class=\"row no-gutters justify-content-around\" style=\"height: 100%\"><div class=\"arr-previous-md\" style=\"color: lightgrey\" id=\"previousMonth\"><span class=\"icon-chevron-thin-left\"></span></div><div style=\"height: 100%\"><h5 class=\"label-think-md\" id=\"selectedMonth\">'+this.GetMonthName(this.SelectedMonth)+'</h5></div><div class=\"arr-next-md\" style=\"color: lightgrey\" id=\"nextMonth\"><span class=\"icon-chevron-thin-right\"></span></div></div></div>'}GetMonthDays(){var e=$(\"<section></section\"),t=this.GetDaysInMonth(this.SelectedMonth,this.SelectedYear),a=1,n=new Date(this.SelectedYear,this.SelectedMonth,1).getDay();0==n&&(n=7);for(var o=$('<div class=\"row no-gutters justify-content-around month-days-list\" style=\"height: 50px\"></div>'),i=1;i<8;i++)i<n?o.append('<div class=\"col non-selected\"></div>'):(o.append('<div class=\"col\" style=\"height: 50px; width: 50px\"><div class=\"month-day\">'+a+\"</div></div>\"),a++);for(e.append(o);a<=t;){o=$('<div class=\"row no-gutters justify-content-around month-days-list\" style=\"height: 50px\"></div>');for(i=0;i<7&&(o.append('<div class=\"col\" style=\"height: 50px; width: 50px\"><div class=\"month-day\">'+a+\"</div></div>\"),++a!=t+1);i++);for(;o.find(\".col\").length<7;)o.append('<div class=\"col non-selected\"></div>');e.append(o)}return e}GetDaysInMonth(e,t){return new Date(t,parseInt(e)+1,0).getDate()}GetMonthName(e,t){return this.GetMonthList(t)[e]}GetMonthIndex(e,t){return this.GetMonthList(t).indexOf(e,t)}GetMonthList(e){let t;switch(e){case\"short\":t=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"July\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];break;case\"long\":t=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"];break;default:t=[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"July\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"]}return t}GetDayName(e,t){return this.GetDaysList(t)[e]}GetDaysList(e){var t;switch(e){case\"short\":t=[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"];break;case\"long\":t=[\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"];break;default:t=[\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\",\"Sun\"]}return t}isHoliday(e,t){let a=new Date(t.selectedYear,t.selectedMonth,e);return\"Sat\"==GetDayName(a.getDay())||\"Sun\"==GetDayName(a.getDay())}}class d{RenderControl(e,t){let a=$(\"#\"+e.Id),n=e.Name,o=t.GetControlProperties(n);if(null!=o){let e=o.Type,i=o.IconName,l=o.Header,r=t.GetRecordSet();switch(null!=i?$(a).addClass(\"block-center\").append('<span class=\"'+i+'\" aria-hidden=\"true\"></span>'):\"button\"==e&&$(a).append('<div class=\"block-center\"><p>'+l+\"</p></div>\"),e){case\"input\":$(a).append('<div class=\"gs-field-label\"><p>'+l+'</p></div><input class=\"gs-field-input\" />').off(\"ControlFocus\").on(\"ControlFocus\",(e,n)=>{this.SetUpClasses(t),$(a).find(\".gs-field-input\").focus(),$(a).addClass(\"gs-field-is-focused\").find(\".gs-field-counter\").removeClass(\"d-none\")}).off(\"input\").on(\"input\",()=>{event.stopPropagation();let e=\"\",t=$(a).find(\".gs-field-counter\");if(null!=t[0]){let n=$(a).find(\".gs-field-input\").val();e=t[0].innerText.split(\"/\"),t[0].innerText=n.length+\"/\"+e[1],n.length>=e[1]&&($(item).closest(\".gs-field\").addClass(\"gs-field-error\"),setTimeout(()=>{$(item).closest(\".gs-field\").removeClass(\"gs-field-error\")},2e3))}});break;case\"date\":$(a).addClass(\"field-date\").attr(\"data-field-up\",$(a).attr(\"data-field-up\")+\";NotInput\").append('<div class=\"gs-field-label\"><p>'+l+'</p></div><input class=\"gs-field-input\" /><div class=\"pick-divider\"></div><div class=\"pick-area block-center\"><span class=\"icon-calendar\" aria-hidden=\"true\"></span></div>').off(\"ControlFocus\").on(\"ControlFocus\",(e,n)=>{this.SetUpClasses(t),$(a).addClass(\"gs-field-is-focused\")});break;case\"picklist\":$(a).addClass(\"field-picklist\").attr(\"data-field-up\",$(a).attr(\"data-field-up\")+\";NotInput\").append('<div class=\"gs-field-label\"><p>'+l+'</p></div><input class=\"gs-field-input\" /><div class=\"pick-divider\"></div><div class=\"pick-area block-center\"><span class=\"icon-chevron-thin-right\" aria-hidden=\"true\"></span></div>').off(\"ControlFocus\").on(\"ControlFocus\",(e,n)=>{$(a).addClass(\"gs-field-is-focused\"),this.SetUpClasses(t)});break;case\"checkbox\":$(a).removeClass(\"gs-field\").addClass(\"field-checkbox\").append('<div class=\"checkbox-check\"></div><div>'+l+\"</div>\").off(\"ControlFocus\").on(\"ControlFocus\",(e,n)=>{this.SetUpClasses(t),$(a).hasClass(\"gs-field-is-filled\")?$(a).removeClass(\"gs-field-is-filled\"):$(a).addClass(\"gs-field-is-filled\")})}if(\"button\"!=e&&null!=r)if(\"\"!=r[n]&&null!=r[n])switch(e){case\"checkbox\":r[n]?$(a).addClass(\"gs-field-is-filled\"):$(a).removeClass(\"gs-field-is-filled\");break;default:null!=r[n]&&$(a).addClass(\"gs-field-is-filled\").find(\".gs-field-input\").val(r[n])}else $(a).removeClass(\"gs-field-is-filled\");$(a).off(\"ControlFocusOut\").on(\"ControlFocusOut\",(t,n)=>{let o=\"checkbox\"==e?!!$(a).hasClass(\"gs-field-is-filled\"):$(a).find(\".gs-field-input\").val();$(a).removeClass(\"gs-field-is-focused\"),\"picklist\"==e&&($(a).removeClass(\"gs-field-is-focused\"),$(a).find(\".icon-chevron-thin-left\").removeClass(\"icon-chevron-thin-left\").addClass(\"icon-chevron-thin-right\")),\"input\"==e&&(\"\"==o?$(a).removeClass(\"gs-field-is-filled\").find(\".gs-field-counter\").addClass(\"d-none\"):$(a).closest(\".gs-field\").addClass(\"gs-field-is-filled\")),$(a).trigger(\"UpdateControl\",[{Event:n.Event,NewValue:o}])})}return a}SetUpClasses(e){$(\"#\"+e.Id)[0].querySelectorAll('[data-type=\"control\"]').forEach(e=>{})}}class p{RenderPickList(e,t){if($('[data-type=\"PopupArea\"]').hasClass(\"d-none\")){let t=e.offset().top+e.height()+2;t+300>$(document).height()&&(t=t-300-e.height()-2);let a=e.offset().left;$('[data-type=\"SelectArea\"]').css(\"left\",a).css(\"top\",t)}else{let t=e.offset().top+e.height()+2;t+300>$(document).height()&&(t=t-300-e.height());let a=e.offset().left;$('[data-type=\"SelectArea\"]').css(\"left\",a).css(\"top\",t)}return $(e).find(\".icon-chevron-thin-right\").removeClass(\"icon-chevron-thin-right\").addClass(\"icon-chevron-thin-left\"),$('[data-type=\"SelectArea\"]').removeClass(\"d-none\").append('<div data-type=\"PickList\" class=\"gs-picklist\"></div>'),t.forEach(e=>{$(\".gs-picklist\").append('<div data-type=\"PickListItem\" class=\"picklist-item block-center\"><p class=\"label-sm\">'+e+\"</p></div>\")}),$('[data-type=\"PickListItem\"]').off(\"PickListItemSelect\").on(\"PickListItemSelect\",(t,a)=>{$(e).find(\".gs-field-input\").val(a.NewValue)}),$(e)}SetCurrentElement(e){$(\"#\"+e).addClass(\"picklist-item-focused\"),$('[data-type=\"PickList\"]').animate({scrollTop:$(\"#\"+e).offset().top-$('[data-type=\"PickList\"]').offset().top-20},300)}}class c{Initialize(e,t){return new Promise((a,n)=>{$('[data-type=\"SelectArea\"]').empty().width($(t).width()+2).attr(\"data-target-id\",$(t).attr(\"id\"));let o=GSCrmInfo.CurrentElementsInfo,i=o.View,l=o.TargetApplet,r=o.PopupApplet,s=o.Record,d=l.GetRecordSet(),c={ViewName:i.Name,CurrentApplet:l.Name,CurrentRecord:null==s?null:s.Id,CurrentControl:o.ControlName,Action:\"OpenPickList\"};null!=r&&null!=r&&(c.CurrentPopupControl=o.ControlName,d=r.GetRecordSet()),i.UpdateViewInfo(c).catch(e=>n(e)).then(()=>{GSCrmInfo.Application.CommonRequests.GetPickListRecords(e).catch(e=>n(e)).then(i=>{if(null!=i){GSCrmInfo.SetElement(\"Picklist\",i);let s=new p,m=0;s.RenderPickList(t,i.DisplayedPickListRecords.map(e=>(e.PickListItemId=\"PickListItem_\"+m++,e.Value))),m=0,$('[data-type=\"SelectArea\"]').find('[data-type=\"PickListItem\"]').map((e,t)=>$(t).attr(\"id\",\"PickListItem_\"+m++));let f=i.DisplayedPickListRecords.filter(e=>e.Id==i.PickListInfo.CurrentRecordId)[0];null!=f&&s.SetCurrentElement(f.PickListItemId),$('[data-type=\"SelectArea\"]').find('[data-type=\"PickListItem\"]').off(\"click\").on(\"click\",s=>{null==r&&(GSCrmInfo.SetElement(\"AppletToUpdate\",l),GSCrmInfo.SetElement(\"UpdateRecordSet\",!0),GSCrmInfo.SetElement(\"RecordToUpdate\",d));let p=i.DisplayedPickListRecords.filter(e=>e.PickListItemId==$(s.currentTarget).attr(\"id\"))[0];c={PickedRecord:p.Id},d[e.Name]=p.Value,GSCrmInfo.Application.CommonRequests.SetPickListRecord(e,c).fail(e=>n(e)).done(()=>{$(s.currentTarget).trigger(\"PickListItemSelect\",[{Event:s,NewValue:p.Value}]),GSCrmInfo.Application.CloseSelectArea(),r=o.PopupApplet,null!=r&&0!=r.Info.Initflag||$(t).trigger(\"ControlChange\",[{Event:s}]),a()})})}else GSCrmInfo.Application.CloseSelectArea()})})})}}var m=function(){let e=function(e,t,a){this.Id=a,this.Name=t;let n=e.GetControlProperties(this.Name);null!=n&&(this.Routing=n.Routing)};return e.prototype.Initialize=function(e){let t=$(\"#\"+this.Id),a=e.GetControlProperties(this.Name);if(null!=a){let n=a.Type;$(t).attr(\"id\",this.Id).addClass(a.CssClass);let o=new d;t=o.RenderControl(this,e);let i=e.GetRecordSet();\"button\"==n?$(t).addClass(a.CssClass).off(\"click\").on(\"click\",o=>{o.stopPropagation(),null==$(t).attr(\"disabled\")&&($('[data-type=\"ExpectationArea\"]').removeClass(\"d-none\"),$('[data-type=\"control\"]').attr(\"disabled\",!0),$('[data-type=\"applet_item\"]').attr(\"disabled\",!0),this.UpdateRescordSet(n).catch(e=>console.log(e)).then(()=>e.InvokeAction(o,a)))}):$(t).off(\"click\").on(\"click\",e=>{e.stopPropagation(),GSCrmInfo.SetUpCurrentElements(e),this.UpdateRescordSet(n).catch(e=>console.log(e)).then(()=>{$(t).trigger(\"ControlFocus\",[{Event:e}]);let a=GSCrmInfo.CurrentElementsInfo.PopupApplet;switch(n){case\"date\":if($('[data-type=\"SelectArea\"]').attr(\"data-target-id\")!=$(t).attr(\"id\")){(new Calendar).Initialize(this,e)}break;case\"picklist\":if(null!=i&&$('[data-type=\"SelectArea\"]').attr(\"data-target-id\")!=$(t).attr(\"id\"))(new c).Initialize(this,t).catch(e=>console.log(e));break;case\"checkbox\":$(t).trigger(\"UpdateControl\",[{Event:e,NewValue:0==i[this.Name]}]),null!=a&&0==a.Info.Initflag&&$(t).trigger(\"ControlChange\",[{Event:e,NeedUpdate:!1}])}\"block\"==$('[data-type=\"SelectArea\"]').css(\"display\")&&$('[data-type=\"SelectArea\"]').attr(\"data-target-id\")!=$(t).attr(\"id\")&&GSCrmInfo.Application.CloseSelectArea()})}).off(\"focusout\").on(\"focusout\",e=>$(t).trigger(\"ControlFocusOut\",[{Event:e}])).off(\"UpdateControl\").on(\"UpdateControl\",(e,a)=>{let o=a.NewValue;if(null!=i&&i[this.Name]!=o&&(null!=i[this.Name]||\"\"!=o)){i[this.Name]=o;let e=GSCrmInfo.CurrentElementsInfo.PopupApplet;null==e?$(t).trigger(\"ControlChange\",[{Event:a.Event,NeedUpdate:!0}]):e.Info.Initflag||\"picklist\"==n||\"checkbox\"==n||$(t).trigger(\"ControlChange\",[{Event:a.Event,NeedUpdate:!1}])}}).off(\"ControlChange\").on(\"ControlChange\",(t,a)=>{let n=e.GetRecordSet();GSCrmInfo.CurrentElementsInfo.View.RefreshAppletUI(e,n),a.NeedUpdate&&null!=n&&(GSCrmInfo.SetElement(\"AppletToUpdate\",e),GSCrmInfo.SetElement(\"UpdateRecordSet\",!0),GSCrmInfo.SetElement(\"RecordToUpdate\",n))})}},e.prototype.UpdateRescordSet=function(e){return new Promise((t,a)=>{let n=GSCrmInfo.CurrentElementsInfo,o=n.RecordToUpdate;!n.UpdateRecordSet||null!=n.PopupApplet||n.Record.Id==o.Id&&\"button\"!=e?t():GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",event,o).catch(e=>a(e)).then(()=>t())})},e}();class f{RenderApplet(e){let t=GSCrmInfo.GetAppletInfo(e),a=$(\"#\"+t.AppletId);return a.empty().addClass(\"gs-applet\").append('<div class=\"def-form-wrapper\"><div class=\"applet-header\"></div><div class=\"row justify-content-between\"></div></div>'),null!=t.Header&&a.find(\".applet-header\").append(\"<p>\"+t.Header+\"</p>\"),t.Controls.forEach((e,t)=>{let n='<div class=\"col-md-4 col-lg-4 mb-4\"><div class=\"gs-field\" style=\"width: 80%; margin-left: 10%\" data-type=\"control\" data-name=\"'+e.Name+'\" tabindex=\"'+t+'\"></div></div>';switch(e.Type){case\"button\":a.find(\".row\").append('<div class=\"col-md-4 col-lg-4 mb-4\"><div style=\"width: 80%; margin-left: 10%\" data-type=\"control\" data-name=\"'+e.Name+'\" tabindex=\"'+t+'\"></div></div>');break;case\"input\":case\"checkbox\":case\"picklist\":a.find(\".row\").append(n)}}),a}}class u{Initialize(e){e.stopPropagation();let t=new n,a=GSCrmInfo.ApplicationInfo,o=t.RenderNavbar(e,a.Screens,a.CurrentScreen,!0);$(o).closest('[data-type=\"GSCrmHeader\"]').find('[data-type=\"NavbarToggler\"]').attr(\"collapsed\",\"true\"),$(o).off(\"SelectScreenMenuItem\").off(\"SelectScreenItem\").on(\"SelectScreenMenuItem\",(e,a)=>{t.HideNavbar();let n=GSCrmInfo.CurrentElementsInfo;n.UpdateRecordSet?GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",e,n.RecordToUpdate).catch(e=>console.log(e)).then(()=>{GSCrmInfo.Application.SelectScreenMenuItem(a.Event,a.Screen,a.View).catch(e=>console.log(e))}):GSCrmInfo.Application.SelectScreenMenuItem(a.Event,a.Screen,a.View).catch(e=>console.log(e))}).on(\"SelectScreenItem\",(e,a)=>{t.HideNavbar();let n=GSCrmInfo.CurrentElementsInfo;n.UpdateRecordSet?GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",e,n.RecordToUpdate).catch(e=>console.log(e)).then(()=>{GSCrmInfo.Application.SelectScreenItem(a.Event,a.Screen,a.View).catch(e=>console.log(e))}):GSCrmInfo.Application.SelectScreenItem(a.Event,a.Screen,a.View).catch(e=>console.log(e))})}Dispose(e){e.stopPropagation();let t=new n,a=GSCrmInfo.ApplicationInfo,o=t.DisposeNavbar(e,a.Screens,a.CurrentScreen);$(o).closest('[data-type=\"GSCrmHeader\"]').find('[data-type=\"NavbarToggler\"]').attr(\"collapsed\",\"false\")}}class h{RenderApplet(e){let t=GSCrmInfo.CurrentElementsInfo.PopupApplet,a=GSCrmInfo.CurrentElementsInfo.TargetApplet,n=t.Info,o=n.AppletId;var i=n.Controls;$('[data-type=\"PopupArea\"]').empty().append('<div class=\"p-modal-'+e+'\"><div class=\"popup-wrap\"><div class=\"row p-modal-head\"><div class=\"p-modal-dummy\"><div></div></div><div><h4>'+n.Header+'</h4></div><div class=\"p-modal-close\"><div></div></div></div><div class=\"divider-mr-none\"></div><div class=\"p-modal-body\"></div><div class=\"divider-mr-none\"></div><div class=\"p-modal-footer\"></div></div></div>').removeClass(\"d-none\"),$('[data-type=\"MaskArea\"]').removeClass(\"d-none\"),window.innerWidth<992&&$(\"html\").css(\"overflow\",\"hidden\"),$(\".popup-wrap\").attr(\"id\",n.AppletId).attr(\"data-name\",n.Name).attr(\"data-type\",\"applet\").attr(\"data-target-id\",a.GetId());var l=$('<div class=\"row justify-content-around\"><div class=\"col-md\"><div class=\"row justify-content-center\"><div class=\"block-center\"><p class=\"label-md\">Fill in the data</p></div></div><div class=\"divider-mr-md\"></div><div class=\"row justify-content-center\" id=\"Fields_'+o+'\"></div></div><div class=\"col-md\"><div class=\"row justify-content-center\"><div class=\"block-center\"><p class=\"label-md\">Actions</p></div></div><div class=\"divider-mr-md\"></div><div class=\"d-flex flex-row flex-md-column flex-lg-row flex-wrap\" id=\"Actions_'+o+'\"></div></div></div>');i.forEach((e,t)=>{let a=e.Name;switch(e.Type){case\"button\":l.find(\"#Actions_\"+o).append('<div class=\"col-auto ml-auto mr-auto mb-4\"><div data-type=\"control\" data-name=\"'+a+'\" tabindex=\"'+t+'\"></div></div>');break;case\"checkbox\":let e=$('<div class=\"col-auto\" style=\"width: 80%; margin: auto; height: 45px\"><div class=\"gs-field\" data-type=\"control\" data-name=\"'+a+'\" style=\"margin: auto\" tabindex=\"'+t+'\"></div></div>');i[t+1]&&\"checkbox\"==i[t+1].Type?e.addClass(\"mb-1\"):e.addClass(\"mb-3\"),l.find(\"#Fields_\"+o).append(e);break;case\"picklist\":let n=$('<div class=\"col-auto\" style=\"width: 80%; margin: auto; height: 45px\"><div class=\"gs-field\" data-type=\"control\" data-name=\"'+a+'\" style=\"margin: auto\" tabindex=\"'+t+'\"></div></div>');i[t+1]&&\"checkbox\"==i[t+1].Type?n.addClass(\"mb-1\"):n.addClass(\"mb-3\"),l.find(\"#Fields_\"+o).append(n);break;case\"input\":let r=$('<div class=\"col-auto\" style=\"width: 80%; margin: auto\"><div class=\"gs-field\" data-type=\"control\" data-name=\"'+a+'\" style=\"margin: auto\" tabindex=\"'+t+'\"></div></div>');i[t+1]&&\"checkbox\"!=i[t+1].Type?r.addClass(\"mb-4\"):r.addClass(\"mb-3\"),l.find(\"#Fields_\"+o).append(r)}}),$(\"#\"+o).find(\".p-modal-body\").append(l)}}class S{static InitializeApplication(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Application/InitializeApplication/\"})}static GetApplicationInfo(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Application/ApplicationInfo\"})}static UpdateApplicationInfo(e){return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Application/UpdateApplicationInfo/\",data:JSON.stringify(e)})}static InitializeScreen(e){return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Screen/InitializeScreen/\"+e.NewScreenName,data:JSON.stringify(e)})}static GetScreenInfo(e){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Screen/ScreenInfo/\"+e})}static UpdateScreenInfo(e){return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Screen/UpdateScreenInfo/\",data:JSON.stringify(e)})}static InitializeView(e){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/View/InitializeView/\"+e})}static GetViewInfo(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/View/ViewInfo\"})}static UpdateViewInfo(e){return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:\"/api/View/UpdateViewInfo\",data:JSON.stringify(e)})}static UpdateContext(e){var t={ViewName:e};return $.ajax({type:\"Post\",contentType:\"application/json\",url:\"/api/View/UpdateContext\",data:JSON.stringify(t)})}static PartialUpdateContext(e,t,a){let n={viewName:GSCrmInfo.CurrentElementsInfo.View.GetName(),appletName:e.Name,id:t,refreshCurrentApplet:a};return $.ajax({type:\"Post\",contentType:\"application/json\",url:\"/api/View/PartialUpdateContext\",dataType:\"json\",data:JSON.stringify(n)})}static InitializeApplet(e){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Applet/InitializeApplet/\"+e})}static GetAppletInfo(e){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Applet/AppletInfo\"})}static GetRecords(e){var t={AppletName:e.Name};return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:e.Routing+\"GetRecords\",data:JSON.stringify(t)})}static GetRecord(e){return $.ajax({type:\"GET\",contentType:\"application/json\",url:e.Routing+\"GetRecord/\"+e.Name,dataType:\"json\"})}static NewRecord(e,t){return $.ajax({type:\"Post\",contentType:\"application/json\",dataType:\"json\",url:e.Info.Routing+\"NewRecord\",data:JSON.stringify(t)})}static UpdateRecord(e,t){return $.ajax({type:\"Post\",contentType:\"application/json\",url:e.Info.Routing+\"UpdateRecord\",dataType:\"json\",data:JSON.stringify(t)})}static DeleteRecord(e,t){return $.ajax({type:\"Post\",contentType:\"application/json\",url:e.Info.Routing+\"DeleteRecord\",dataType:\"json\",data:JSON.stringify(t)})}static ApplyTable(e){return $.ajax({type:\"Get\",contentType:\"application/json\",url:e.Info.BusCompRouting+\"ApplyTable\"})}static GenerateCode(e){return $.ajax({type:\"Get\",contentType:\"application/json\",url:e.Info.BusCompRouting+\"GenerateCode\"})}static GetPickListRecords(e){return $.ajax({type:\"Get\",contentType:\"application/json\",dataType:\"json\",url:e.Routing+\"PickListRecords\"})}static SetPickListRecord(e,t){return $.ajax({type:\"Post\",contentType:\"application/json\",url:e.Routing+\"Pick\",data:JSON.stringify(t)})}static GetDisplayedRecords(e){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Test/GetDisplayedRecords/\"+e})}static GetSelectedRecords(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Test/GetSelectedRecords/\"})}static GetBackScreenInfo(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Test/GetScreenInfo/\"})}static GetBackViewInfo(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Test/GetViewInfo/\"})}static GetBackAppletInfo(){return $.ajax({type:\"GET\",contentType:\"application/json\",dataType:\"json\",url:\"/api/Test/GetAppletInfo/\"})}}class I{RenderScreen(e){let t=GSCrmInfo.ScreenInfo,a=t.ChildViews;if(t.Crumbs.length>0){let a=$('<div data-type=\"TreadBar\" class=\"gs-treadbar-wrapper\"><div><p class=\"label-lg\">Treads</p></div><div class=\"gs-treadbar mt-4 mb-4\"></div></div>');t.Crumbs.forEach((e,t)=>{0!=t&&a.find(\".gs-treadbar\").append('<span style=\"user-select: none\">&emsp;>&emsp;</span>'),a.find(\".gs-treadbar\").append('<div data-type=\"TreadItem\" class=\"gs-treadbar-item\" id=\"'+e.CrumbId+'\">'+e.Header+\"</div>\")}),a.find(\".gs-treadbar\").append('<span style=\"user-select: none\">&emsp;&emsp;&emsp;&emsp;</span>'),a.find(\".gs-treadbar\").append('<div data-type=\"TreadScroll\" class=\"gs-treadbar-scroll\"><span data-type=\"TreadPrevious\" class=\"icon-backward\" aria-hidden=\"true\"></span><span data-type=\"TreadNext\" class=\"icon-forward\" aria-hidden=\"true\"></span>').on(\"click\",'[data-type=\"TreadPrevious\"]',e=>{$(\".gs-treadbar\")[0].scrollLeft-=100}).on(\"click\",'[data-type=\"TreadNext\"]',e=>{$(\".gs-treadbar\")[0].scrollLeft+=100}),$(e).append(a)}return $(e).on(\"OnViewLoad\",()=>{a.length>0&&($(e).append('<div class=\"gs-tabs\"><div class=\"gs-tabs-header\"><p class=\"label-lg\">Child views</p></div><div class=\"gs-tabs-body mt-4 mb-4\"></div></div>'),a.forEach(e=>{let a=$('<div class=\"gs-tab\" data-type=\"ScreenItem\" data-name=\"'+e.Name+'\"><div><p class=\"label-md\">'+e.Header+\"</p></div><div></div></div>\");e.Name==t.CurrentView.Name&&a.addClass(\"gs-tab-focused\"),$(\".gs-tabs-body\").append(a)}))}),e}}var C=function(){let e=function(e,t){this.Id=t,this.Name=e,this.Info=GSCrmInfo.ScreenInfo.Name==this.Name?GSCrmInfo.ScreenInfo.Name:void 0,null!=this.Info&&(this.Id=this.Info.ScreenId)};return e.prototype.GetId=function(){return this.Id},e.prototype.GetName=function(){return this.Name},e.prototype.GetInfo=function(){return this.Info},e.prototype.Initialize=function(e){return new Promise((t,a)=>{GSCrmInfo.Application.CommonRequests.InitializeScreen(e).fail(e=>a(e)).done(e=>{GSCrmInfo.ScreenInfo=e,GSCrmInfo.SetElement(\"Screen\",this),this.Info=e,Object.is(this.Info.CurrentView,null)||this.RenderScreen(this.Info.CurrentView.Name).catch(e=>a(e)).then(()=>t())})})},e.prototype.RenderScreen=function(e){return new Promise((t,a)=>{let n=$('<div data-type=\"Screen\" data-name=\"'+this.Info.Name+'\"></div>');GSCrmInfo.ScreenInfo.Crumbs.map((e,t)=>{e.CrumbId=\"Crumb_\"+t});let o=new I;n=o.RenderScreen(n),$(\".large-container\").empty().append(n);let i=new GSCrmInfo.Application.View(e);i.Initialize(n).catch(e=>a(e)).then(e=>{let o=e.GetInfo().ViewItems[0],l=GSCrmInfo.GetSelectedRecord(o.AppletName);switch(GSCrmInfo.SetElement(\"View\",e),o.Type){case\"Tile\":GSCrmInfo.SetElement(\"TargetApplet\",new GSCrmInfo.Application.TileApplet(o.AppletName,null));break;case\"Form\":GSCrmInfo.SetElement(\"TargetApplet\",new GSCrmInfo.Application.FormApplet(o.AppletName,null))}null!=l&&GSCrmInfo.SetElement(\"Record\",l.properties);let r=GSCrmInfo.CurrentElementsInfo;$(n).find('[data-type=\"ScreenItem\"]').off(\"click\").on(\"click\",e=>{if($(n).trigger(\"SelectScreenItem\",[{Event:e}]),r.UpdateRecordSet)GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",e,r.RecordToUpdate).catch(e=>console.log(e)).then(()=>{let n=$(e.currentTarget).closest('[data-type=\"ScreenItem\"]').attr(\"data-name\");GSCrmInfo.Application.SelectScreenItem(e,this.Name,n).catch(e=>a(e)).then(()=>t())}).finally(()=>{GSCrmInfo.SetElement(\"AppletToUpdate\",null),GSCrmInfo.SetElement(\"UpdateRecordSet\",!1),GSCrmInfo.SetElement(\"RecordToUpdate\",null)});else{let n=$(e.currentTarget).closest('[data-type=\"ScreenItem\"]').attr(\"data-name\");GSCrmInfo.Application.SelectScreenItem(e,this.Name,n).catch(e=>a(e)).then(()=>t())}}),$(n).find('[data-type=\"TreadItem\"]').off(\"click\").on(\"click\",e=>{$(n).trigger(\"SelectTreadItem\",[{Event:e}]),r.UpdateRecordSet?GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",e,r.RecordToUpdate).catch(e=>console.log(e)).then(()=>GSCrmInfo.Application.SelectTreadItem(e,this,i)).finally(()=>{GSCrmInfo.SetElement(\"AppletToUpdate\",null),GSCrmInfo.SetElement(\"UpdateRecordSet\",!1),GSCrmInfo.SetElement(\"RecordToUpdate\",null)}):GSCrmInfo.Application.SelectTreadItem(e,this,i)}),t()})})},e.prototype.RequestInfo=function(){return new Promise((e,t)=>{GSCrmInfo.Application.CommonRequests.GetScreenInfo(this.Name).fail(e=>t(e)).done(t=>e(t))})},e.prototype.UpdateInfo=function(e){return new Promise((t,a)=>{GSCrmInfo.Application.CommonRequests.UpdateScreenInfo(e).fail(e=>a(e)).done(e=>{GSCrmInfo.ScreenInfo=e,t()})})},e}();class y{RenderApplet(e,t){let a=GSCrmInfo.GetAppletInfo(e),n=new GSCrmInfo.Application.TileApplet(e,a.AppletId),o=$(\"#\"+a.AppletId),i=n.GetColumnsProperty(\"Name\"),l=n.GetColumnsProperty(\"Header\"),r=n.GetControlProperties(\"NewRecord\"),s=(n.GetControlProperties(\"AppletConfg\"),n.GetControlProperties(\"UpdateRecord\")),d=n.GetControlProperties(\"DeleteRecord\"),p=n.GetControlProperties(\"NextRecords\"),c=n.GetControlProperties(\"PreviousRecords\");o.find(\".def-wrapper\").remove(),o.find(\".nav-records\").remove(),o.addClass(\"gs-applet\").off(\"scroll\").off(\"OnAppletReady\").off(\"ClearAppletItemsFocus\").on(\"ClearAppletItemsFocus\",e=>{$(e.currentTarget).closest('[data-type=\"applet\"]').find(\".def-tile-item-static\").removeClass(\"def-tile-item-static\")}).on(\"scroll\",e=>{$(e.currentTarget).find(\".header-items .row-actions\").css(\"right\",\"0px\")});let m=$('<div class=\"def-tile-body\"></div>');if(0==t)o.append('<div class=\"def-wrapper\"><div class=\"applet-header\"><p>'+a.Header+'</p></div><div class=\"def-tile-empty\"><div class=\"def-tile-header\"><div class=\"row no-gutters header-items\"></div></div></div></div>'),l.forEach(e=>{o.find(\".header-items\").append('<div class=\"col\"><div class=\"block-center\"><p class=\"label-fat-sm\">'+e+\"</p></div></div>\")}),o.find(\".header-items\").append('<div class=\"row-actions\"><div class=\"row action-md\"><div class=\"tile-create\" data-type=\"control\" data-name=\"'+r.Name+'\"></div><div class=\"tile-confg\" data-type=\"control\" data-name=\"AppletConfg\"></div></div></div>'),o.find(\".def-tile-empty\").append('<div class=\"row def-tile-empty-state\"><div class=\"col-auto\"><img src=\"/img/default-empty.svg\" /></div><div class=\"col-auto\"><div class=\"block-center\"><h3>'+a.EmptyState+\"</h3></div></div></div>\");else{o.append('<div class=\"def-wrapper\"><div class=\"applet-header\"><p>'+a.Header+'</p></div><div class=\"def-tile\"><div class=\"def-tile-header\"><div class=\"header-items\"></div></div></div></div>'),l.forEach(e=>{o.find(\".header-items\").append('<div class=\"label-fat-sm\">'+e+\"</div>\")}),o.find(\".header-items\").append('<div class=\"row-actions\"><div class=\"row action-md\"><div class=\"tile-create\" data-type=\"control\" data-name=\"'+r.Name+'\"></div><div class=\"tile-confg\" data-type=\"control\" data-name=\"AppletConfg\"></div></div></div>');for(let a=0;a<t;a++){let t=$('<div class=\"def-tile-item\" data-type=\"applet_item\"></div>');t.off(\"FocusAppletItem\").off(\"AppletItemMouseOver\").off(\"AppletItemMouseOut\").on(\"FocusAppletItem\",t=>{$(t.currentTarget).closest('[data-type=\"applet\"]').find(\".def-tile-item-static\").removeClass(\"def-tile-item-static\"),GSCrmInfo.GetSelectedRecord(e).record.addClass(\"def-tile-item-static\")}).on(\"AppletItemMouseOver\",e=>$(e.currentTarget).addClass(\"def-tile-item-focused\")).on(\"AppletItemMouseOut\",e=>$(e.currentTarget).removeClass(\"def-tile-item-focused\")),m.append(t),i.forEach(e=>{let t=$('<div data-type=\"cell\" data-name=\"'+e+'\"></div>');m.find('[data-type=\"applet_item\"]').last().append(t)}),m.find('[data-type=\"applet_item\"]').last().append('<div class=\"row-actions\"><div class=\"row action-md\"><div class=\"tile-edit\" data-type=\"control\" data-name=\"'+s.Name+'\"></div><div class=\"tile-delete\" data-type=\"control\" data-name=\"'+d.Name+'\"></div></div></div>')}o.find(\".def-tile\").append(m);var f=$('<div class=\"row nav-records\"><div class=\"col-auto\"><div class=\"previous-nav\"><div data-type=\"control\" data-name=\"'+c.Name+'\"></div></div></div><div class=\"col-auto\"><div class=\"next-nav\"><div data-type=\"control\" data-name=\"'+p.Name+'\"></div></div></div></div>');o.find(\".def-wrapper\").append(f)}}RenderCell(e,t,a,n){switch(n){case\"checkbox\":let a=$('<div class=\"field-checkbox-tile\"><div class=\"checkbox-check\"></div></div>');1==t?a.addClass(\"gs-field-is-filled\"):a.removeClass(\"gs-field-is-filled\"),$(e).empty().append(a),a.off(\"click\").on(\"click\",t=>{a.hasClass(\"gs-field-is-filled\")?a.removeClass(\"gs-field-is-filled\"):a.addClass(\"gs-field-is-filled\"),$(e).trigger(\"CellCnange\",[{Event:t,CellNewValue:!!a.hasClass(\"gs-field-is-filled\")}])});break;default:$(e).text(t)}}}class v{RenderView(e){let t=$('<div class=\"gs-view\" data-type=\"view\" data-name=\"'+e.Name+'\"></div>'),a=\"GSV_0\",n=0;for(;$(\"#\"+a).length>0;)a=a.split(n).join(n+1),n++;return t.attr(\"id\",a),t}}var g,A=function(){let e=function(e){this.Name=e,this.Info=GSCrmInfo.GetViewInfo(e),null!=this.Info&&(this.Id=this.Info.ViewId)};return e.prototype.GetId=function(){return this.Id},e.prototype.GetName=function(){return this.Name},e.prototype.GetInfo=function(){return this.Info},e.prototype.Initialize=function(e){return new Promise((t,a)=>{$('[data-type=\"ExpectationArea\"]').removeClass(\"d-none\"),GSCrmInfo.Application.CommonRequests.InitializeView(this.Name).fail(e=>a(e)).done(n=>{let o=(new v).RenderView(this);n.ViewId=$(o).attr(\"id\"),this.Id=$(o).attr(\"id\"),this.Info=n,GSCrmInfo.RemoveOldViewInfo(),GSCrmInfo.SetViewInfo(this.Name,n),$(e).append(o),GSCrmInfo.Application.CommonRequests.UpdateContext(this.Name).catch(e=>a(e)).then(()=>{this.InitializeItems(o,n.ViewItems,0).catch(e=>a(e)).then(()=>{$(e).trigger(\"OnViewLoad\",[]),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t(this)})})})})},e.prototype.InitializeItems=function(e,t,a){return new Promise((n,o)=>{if(null!=t[a]){let i=t[a].AppletName,l=\"GSA_0\",r=0;for(;$(\"#\"+l).length>0;)l=l.split(r).join(r+1),r++;switch(t[a].Type){case\"Tile\":e.append('<div data-type=\"applet\" data-name=\"'+i+'\" id=\"'+l+'\"></div>'),new GSCrmInfo.Application.TileApplet(i,l).Initialize().catch(e=>o(e)).then(()=>{a++,this.InitializeItems(e,t,a).catch(e=>o(e)).then(()=>n())});break;case\"Form\":e.append('<div data-type=\"applet\" data-name=\"'+i+'\" id=\"'+l+'\"></div>'),new GSCrmInfo.Application.FormApplet(i,l).Initialize().catch(e=>o(e)).then(()=>{a++,this.InitializeItems(e,t,a).catch(e=>o(e)).then(()=>n())})}}else n()})},e.prototype.RequestInfo=function(){return new Promise((e,t)=>{GSCrmInfo.Application.CommonRequests.GetViewInfo().fail(e=>t(e)).done(t=>{GSCrmInfo.RemoveOldViewInfo(),GSCrmInfo.SetViewInfo(this.Name,t),e()})})},e.prototype.UpdateViewInfo=function(e){return new Promise((t,a)=>{GSCrmInfo.Application.CommonRequests.UpdateViewInfo(e).fail(e=>a(e)).done(e=>{GSCrmInfo.RemoveOldViewInfo(),GSCrmInfo.SetViewInfo(this.Name,e),t()})})},e.prototype.UpdateContext=function(){return new Promise((e,t)=>{GSCrmInfo.Application.CommonRequests.UpdateContext(this.Name).fail(e=>t(e)).done(a=>{a.length>0?this.RefreshApplets(a,0).catch(e=>t(e)).then(()=>e()):e()})})},e.prototype.PartialUpdateContext=function(e,t,a){return new Promise((n,o)=>{GSCrmInfo.Application.CommonRequests.PartialUpdateContext(e,t,a).fail(e=>o(e)).done(e=>{e.length>0?this.RefreshApplets(e,0).catch(e=>o(e)).then(()=>n()):n()})})},e.prototype.RefreshApplets=function(e,t){return new Promise((a,n)=>{if(null!=e[t]){let o,i=e[t];switch(this.GetAppletByName(i).Type){case\"Tile\":o=new GSCrmInfo.Application.TileApplet(i,null);break;case\"Form\":o=new GSCrmInfo.Application.FormApplet(i,null)}o.Initialize().catch(e=>n(e)).then(()=>{t++,this.RefreshApplets(e,t),a()})}})},e.prototype.RefreshApplet=function(e){return new Promise((t,a)=>{let n;switch(this.GetAppletByName(e).Type){case\"Tile\":n=new GSCrmInfo.Application.TileApplet(e,null);break;case\"Form\":n=new GSCrmInfo.Application.FormApplet(e,null)}n.Initialize().catch(e=>a(e)).then(()=>{count++,this.RefreshApplets(applets,count),t()})})},e.prototype.RefreshAppletUI=function(e,t){let a=this.GetRelatedApplets(e.Name);a.push(e),a.map(e=>{switch(e.GetInfo().Type){case\"Tile\":e.UpdateRecordInRS(t,\"Id\",t.Id),e.RefreshTileItem(e.GetTileItemByIdInRS(t.Id));break;case\"Form\":e.UpdateRecordInRS(t),e.RefreshData()}})},e.prototype.GetAppletId=function(e){return $(e.currentTarget).closest('[data-type=\"applet\"]').attr(\"id\")},e.prototype.GetAppletName=function(e){return this.GetAppletNameById(this.GetAppletId(e))},e.prototype.GetAppletIdByName=function(e){let t;return GSCrmInfo.AppletsInfo.forEach((a,n)=>{n==e&&(t=a.AppletId)}),t},e.prototype.GetAppletNameById=function(e){let t;return GSCrmInfo.AppletsInfo.forEach((a,n)=>{a.AppletId==e&&(t=n)}),t},e.prototype.GetAppletByName=function(e){return GSCrmInfo.ViewsInfo.get(this.Name).ViewItems.filter(t=>t.AppletName==e)[0]},e.prototype.GetRelatedApplets=function(e){let t=[],a=GSCrmInfo.GetAppletInfo(e);return GSCrmInfo.AppletsInfo.forEach(n=>{if(n.BusCompName==a.BusCompName&&n.Name!=e)switch(n.Type){case\"Tile\":t.push(new GSCrmInfo.Application.TileApplet(n.Name,n.Id));break;case\"Form\":t.push(new GSCrmInfo.Application.FormApplet(n.Name,n.Id))}}),t},e.prototype.GetTargetId=function(e){return $(e.currentTarget).closest(\"[data-target-id]\").attr(\"data-target-id\")},e.prototype.CloseSelectArea=function(){let e=$(\"#\"+$('[data-type=\"SelectArea\"]').attr(\"data-target-id\"));e.removeClass(\"gs-field-is-focused\"),\"\"!=e.find(\".gs-field-input\").val()?e.addClass(\"gs-field-is-filled\"):e.removeClass(\"gs-field-is-filled\");let t=this.GetAppletNameById(e.closest('[data-type=\"applet\"]').attr(\"id\"));new GSCrmInfo.Application.Applet(t,null).RecordSet[e.attr(\"data-name\")]=e.find(\".gs-field-input\").val(),$('[data-type=\"SelectArea\"]').addClass(\"d-none\").removeAttr(\"style\").removeAttr(\"data-target-id\").empty(),$(\".pick-area\").css(\"color\",\"lightgrey\").find(\".icon-chevron-thin-left\").removeClass(\"icon-chevron-thin-left\").addClass(\"icon-chevron-thin-right\")},e}(),G=((g=function(e){this.Name=e}).prototype.Initialize=function(){return new Promise((e,t)=>{GSCrmInfo.Application.CommonRequests.InitializeApplication().fail(e=>t(e)).done(a=>{if(sessionStorage.setItem(\"GSCrmApplicationName\",a.Application.Name),sessionStorage.setItem(\"GSCrmApplicationInfo\",JSON.stringify(a)),GSCrmInfo.ApplicationInfo=a,(new o).RenderApplication(),!Object.is(a.CurrentScreen,null)){let n=a.CurrentScreen.Name,o=null==a.CurrentView?null:a.CurrentView.Name,i=new GSCrmInfo.Application.Screen(n);if(\"Home Screen\"!=n){let l={NewScreenName:n,CategoryName:null,NewViewName:o};i.Initialize(l).catch(e=>t(e)).then(()=>e(a))}}e(a)})})},g.prototype.UpdateApplication=function(e){return new Promise((t,a)=>{let n={ScreenName:e.ScreenName,ViewName:e.ViewName};GSCrmInfo.Application.CommonRequests.UpdateApplicationInfo(n).fail(e=>a(e)).done(n=>{if(GSCrmInfo.ApplicationInfo=n,(new o).RenderApplication(),!Object.is(n.CurrentScreen,null)){let o=n.CurrentScreen.Name,i=null==e.CurrentView?null:e.CurrentView.Name,l=new GSCrmInfo.Application.Screen(o),r={NewScreenName:o,CategoryName:e.CategoryName,ViewName:i};l.Initialize(r).catch(e=>a(e)).then(()=>t(e))}})})},g.prototype.CloseSelectArea=function(){(new o).CloseSelectArea(),GSCrmInfo.SetElement(\"Picklist\",null)},g.prototype.GetActiveView=function(e){return $(e.currentTarget).closest('[data-type=\"view\"]').attr(\"data-name\")},g.prototype.GoToScreen=function(e){let t;t=\"Home Screen\"!=e?document.location.protocol+\"//\"+document.location.host+GSCrmInfo.ApplicationInfo.ScreensRouting[e]:document.location.protocol+\"//\"+document.location.host+\"/\",document.location.href=t},g.prototype.SelectScreenMenuItem=function(e,t,a){return new Promise((e,n)=>{let o={ScreenName:t,ViewName:a};GSCrmInfo.Application.CommonRequests.UpdateApplicationInfo(o).catch(e=>n(e)).then(e=>{let a=GSCrmInfo.CurrentElementsInfo.Screen,n=GSCrmInfo.CurrentElementsInfo.View;if(GSCrmInfo.ApplicationInfo=e,null!=n){let e={NewScreenName:t,OldScreenName:a.Name,OldViewName:n.Name,Action:\"SelectScreen\"};a.UpdateInfo(e).catch(e=>console.log(e)).then(()=>GSCrmInfo.Application.GoToScreen(t))}else GSCrmInfo.Application.GoToScreen(t)})})},g.prototype.SelectTreadItem=function(e,t,a){let n=GSCrmInfo.ScreenInfo.Crumbs.filter(t=>t.CrumbId==$(e.currentTarget).closest('[data-type=\"TreadItem\"]').attr(\"id\"))[0],o=n.ScreenName,i=n.ViewName;if(t.Name!=o){let e={ScreenName:o};GSCrmInfo.Application.CommonRequests.UpdateApplicationInfo(e).catch(e=>console.log(e)).then(a=>{GSCrmInfo.ApplicationInfo=a,e={CrumbId:n.Id,NewScreenName:o,CategoryName:n.ParentCategory,NewViewName:i,Action:\"SelectCrumb\"},t.UpdateInfo(e).catch(e=>console.log(e)).then(()=>GSCrmInfo.Application.GoToScreen(o))})}else{let e={CrumbId:n.Id,NewScreenName:t.Name,OldViewName:a.Name,NewViewName:i,Action:\"SelectCrumb\"};t.UpdateInfo(e).catch(e=>reject(e)).then(()=>t.RenderScreen(i))}},g.prototype.SelectScreenItem=function(e,t,a){return new Promise((n,o)=>{let i=GSCrmInfo.CurrentElementsInfo.Screen,l=i.Name;if(t==l){let e=GSCrmInfo.CurrentElementsInfo.View.Name;if(a!=e){let n={OldScreenName:l,NewScreenName:t,OldViewName:e,NewViewName:a,Action:\"SelectScreenItem\"};i.UpdateInfo(n).catch(e=>o(e)).then(()=>i.RenderScreen(a))}}else g.prototype.SelectScreenMenuItem(e,t,a)})},g.prototype.CommonRequests=S,g.prototype.CommonAction=i,g.prototype.Screen=C,g.prototype.View=A,g.prototype.Applet=r,g.prototype.TileApplet=function(e){let t=function(t,a){e.prototype.Applet.apply(this,[t,a])};return(t.prototype=Object.create(e.prototype.Applet.prototype)).Focus=function(e){GSCrmInfo.SetSelectedRecord(this.Name,{record:e,properties:this.GetRecordFromRSByIndex(this.GetSelection(e))}),e[0].dispatchEvent(new CustomEvent(\"FocusAppletItem\",{detail:{}}))},t.prototype.SelectedRecords=function(){var e={};return GSCrmInfo.SelectedRecords.forEach((t,a)=>{e[a]=t}),e},t.prototype.FirstRecord=function(){return this.GetRecordSet()[0]},t.prototype.LastRecord=function(){return this.GetRecordSet()[this.GetRecordSet().length-1]},t.prototype.Columns=function(){return this.Info.Columns},t.prototype.TileItems=function(){return $(\"#\"+this.Info.AppletId).find(\".\"+this.Info.itemClass)},t.prototype.Initialize=function(){return new Promise((e,t)=>{this.InitializeApplet(this.Name).catch(e=>t(e)).then(()=>{GSCrmInfo.Application.CommonRequests.GetRecords(this.Info).fail(e=>t(e.responseJSON)).done(t=>{let a=t.DisplayedRecords,n=t.SelectedRecords;this.SetRecordSet(a),0==a.length?((new y).RenderApplet(this.Name,a.length),this.InitializeControls()):(a.length!=this.Info.TileItems.length&&((new y).RenderApplet(this.Name,a.length),this.InitializeControls()),this.InitializeRows());let o=n[this.Name],i=this.GetTileItemByIdInRS(o),l=this.GetRecordByProperty(\"Id\",o);if(0!=l.length){let e={};e.properties=l,e.record=i,GSCrmInfo.SetSelectedRecord(this.Name,e)}else GSCrmInfo.SetSelectedRecord(this.Name,null);a.length>0&&this.Focus(i),e(t)})})})},t.prototype.InitializeRows=function(){$(\"#\"+this.Id+' [data-type=\"applet_item\"]').each((e,t)=>{$(t).attr(\"id\",\"tile_\"+this.Id+\"_item_\"+e).addClass(this.Info.itemClass).off(\"mouseover\").off(\"mouseout\").off(\"click\").off(\"TileItemSelect\").on(\"mouseover\",e=>{$(e.currentTarget).trigger(\"AppletItemMouseOver\",[])}).on(\"mouseout\",e=>{$(e.currentTarget).trigger(\"AppletItemMouseOut\",[])}).on(\"click\",e=>{$(e.currentTarget).trigger(\"TileItemSelect\",[])}).on(\"TileItemSelect\",e=>{GSCrmInfo.SetUpCurrentElements(e),GSCrmInfo.CurrentElementsInfo.TargetApplet.SelectTileItem(e)}).find('[data-type=\"cell\"]').map((t,a)=>{let n=a.getAttribute(\"data-name\"),o=this.GetColumnProperties(n)[0].Type,i=this.GetRecordSet()[e][n];(new y).RenderCell(a,i,n,o),$(a).off(\"CellCnange\").on(\"CellCnange\",(t,a)=>{a.Event.stopPropagation();let o=GSCrmInfo.CurrentElementsInfo,i=new GSCrmInfo.Application.View(this.Info.View),l=new GSCrmInfo.Application.TileApplet(i.GetAppletName(t),i.GetAppletId(t)),r=this.GetRecordSet()[e],s=o.RecordToUpdate;o.UpdateRecordSet&&s.Id!=r.Id?(GSCrmInfo.SetUpCurrentElements(t),GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",t,s).catch(e=>console.log(e)).then(()=>{GSCrmInfo.SetElement(\"AppletToUpdate\",this),GSCrmInfo.SetElement(\"UpdateRecordSet\",!0),GSCrmInfo.SetElement(\"RecordToUpdate\",r),l.SelectTileItem(t).catch(e=>console.log(e)).then(()=>i.RefreshAppletUI(l,l.GetRecordSet()[this.GetSelection($(t.currentTarget).closest('[data-type=\"applet_item\"]'))]))})):(GSCrmInfo.SetElement(\"AppletToUpdate\",this),GSCrmInfo.SetElement(\"UpdateRecordSet\",!0),GSCrmInfo.SetElement(\"RecordToUpdate\",r),l.SelectTileItem(t).catch(e=>console.log(e)).then(()=>i.RefreshAppletUI(l,l.GetRecordSet()[this.GetSelection($(t.currentTarget).closest('[data-type=\"applet_item\"]'))]))),this.GetRecordSet()[e][n]=a.CellNewValue})})})},t.prototype.RefreshTileItem=function(e){e.find('[data-type=\"cell\"]').map((t,a)=>{let n=a.getAttribute(\"data-name\"),o=this.GetColumnProperties(n)[0].Type,i=this.GetRecordSet()[this.GetSelection(e)][n];return(new y).RenderCell(a,i,n,o),a})},t.prototype.SelectTileItem=function(e){return new Promise((t,a)=>{let n=$(e.currentTarget).closest('[data-type=\"applet_item\"]');if(null==n.attr(\"disabled\")){let o=GSCrmInfo.GetSelectedRecord(this.Name);if(null==o||o.record[0]!=n[0]){this.Focus(n),$('[data-type=\"control\"]').attr(\"disabled\",!0),$('[data-type=\"applet_item\"]').attr(\"disabled\",!0),$('[data-type=\"ExpectationArea\"]').removeClass(\"d-none\");let o=GSCrmInfo.CurrentElementsInfo,i=o.View,l=this.GetRecordFromRS(e).Id,r={ViewName:i.Name,CurrentApplet:this.Name,CurrentRecord:l,CurrentControl:null,Action:\"SelectTileItem\"};o.UpdateRecordSet&&o.RecordToUpdate.Id!=this.GetRecordFromRS(e).Id?GSCrmInfo.Application.CommonAction.Invoke(\"AutoUpdateRecord\",e,o.RecordToUpdate).catch(e=>a(e)).then(()=>{i.UpdateViewInfo(r).catch(e=>a(e)).then(()=>{i.PartialUpdateContext(this.Info,this.GetRecordSet()[this.GetSelection(n)].Id,!1).catch(e=>a(e)).then(()=>{$('[data-type=\"control\"]').attr(\"disabled\",!1),$('[data-type=\"applet_item\"]').attr(\"disabled\",!1),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t()})})}):i.UpdateViewInfo(r).catch(e=>a(e)).then(()=>{i.PartialUpdateContext(this.Info,this.GetRecordSet()[this.GetSelection(n)].Id,!1).catch(e=>a(e)).then(()=>{$('[data-type=\"control\"]').attr(\"disabled\",!1),$('[data-type=\"applet_item\"]').attr(\"disabled\",!1),$('[data-type=\"ExpectationArea\"]').addClass(\"d-none\"),t()})})}else t()}else t()})},t.prototype.GetTileItemByIdInRS=function(e){let t=0;return this.GetRecordSet().forEach((a,n)=>{a.Id==e&&(t=n)}),$(\"#\"+this.Id).find('[data-type=\"applet_item\"]').eq(t)},t.prototype.GetTileItemBySequence=function(e){return $($(\"#\"+this.Info.AppletId).find('[data-type=\"applet_item\"]')[e])},t.prototype.GetSelection=function(e){let t=0;return e.closest('[data-type=\"applet\"]').find('[data-type=\"applet_item\"]').filter((a,n)=>{$(n)[0]==e.closest('[data-type=\"applet_item\"]')[0]&&(t=a)}),t},t.prototype.GetColumnsProperty=function(e){return this.Info.Columns.map(t=>t[e])},t.prototype.GetColumnProperties=function(e){return this.Info.Columns.filter(t=>t.Name==e)},t.prototype.GetColumnsByPropertyValue=function(e,t){return this.Info.Columns.filter(a=>a[e]==t)[0]},t.prototype.GetSelectedRecordsProperty=function(e){let t={};return GSCrmInfo.SelectedRecords.forEach((a,n)=>{t[n]=a.properties[e]}),t},t.prototype.GetSelectedRecordProperty=function(e){return GSCrmInfo.GetSelectedRecord(this.Name).properties[e]},t.prototype.GetRecordFromRS=function(e){let t=$(e.currentTarget).closest('[data-type=\"applet_item\"]');return 0==t.length?null:this.GetRecordSet()[this.GetSelection(t)]},t.prototype.GetRecordFromRSByIndex=function(e){return this.GetRecordSet().filter((t,a)=>a==e)[0]},t}(g),g.prototype.FormApplet=function(e){let t=function(t,a){e.prototype.Applet.apply(this,[t,a])};return(t.prototype=Object.create(e.prototype.Applet.prototype)).Initialize=function(){return new Promise((e,t)=>{this.InitializeApplet(this.Name).catch(e=>t(e)).then(()=>{GSCrmInfo.Application.CommonRequests.GetRecord(this.Info).catch(e=>t(e)).then(t=>{this.SetRecordSet(t);let a=(new f).RenderApplet(this.Name);this.InitializeControls(this.Name),null!=t?GSCrmInfo.SetSelectedRecord(this.Name,{record:a,properties:t}):GSCrmInfo.SetSelectedRecord(this.Name,null),e()})})})},t.prototype.RefreshData=function(){$(\"#\"+this.Id+' [data-type=\"control\"]').empty(),this.InitializeControls()},t}(g),g.prototype.PopupApplet=function(e){let t=function(t,a){e.prototype.Applet.apply(this,[t,a])};return(t.prototype=Object.create(e.prototype.Applet.prototype)).Initialize=function(e){return new Promise((t,a)=>{let n=GSCrmInfo.CurrentElementsInfo,o=(n.View,n.TargetApplet),i=n.ControlName,l=n.Record,r=null==l?null:l.Id,s=$(e.currentTarget).closest('[data-type=\"applet_item\"]');this.InitializeApplet(this.Name).catch(e=>a(e)).then(()=>{this.GetAppletRecord().catch(e=>a(e)).then(e=>{this.SetRecordSet(e);let l=o.GetInfo().ControlUPs[i].filter(e=>\"Size\"==e.Name)[0].Value;(new h).RenderApplet(l),this.InitializeControls(this.Name),\"Tile\"==o.GetInfo().Type&&s.length>0&&null!=r?(o=new GSCrmInfo.Application.TileApplet(o.GetName(),o.GetId()),o.Focus(s),n.View.PartialUpdateContext(o.GetInfo(),r,!1).catch(e=>a(e)).then(()=>t())):t()})})})},t.prototype.Dispose=function(){this.DeleteRecordSet(),GSCrmInfo.RemoveAppletInfo(this.Name),GSCrmInfo.SetElement(\"PopupApplet\",null),GSCrmInfo.SetElement(\"ControlName\",null),GSCrmInfo.Application.CloseSelectArea(),$('[data-type=\"PopupArea\"]').addClass(\"d-none\").empty(),$('[data-type=\"MaskArea\"]').addClass(\"d-none\"),$(\"html\").css(\"overflow\",\"auto\")},t}(g),g.prototype.Control=m,g.prototype.Calendar=s,g.prototype.PickList=c,g.prototype.Navbar=u,g);$(document).off(\"click\").on(\"click\",()=>{!$('[data-type=\"SelectArea\"]').hasClass(\"d-none\")&&GSCrmInfo.Application.CloseSelectArea(),\"block\"==$(\".gs-nav-area\").css(\"display\")&&($(\".gs-nav-toggler-brand\").css(\"display\",\"none\"),$(\".gs-nav-area\").slideUp(\"fast\"));let e=new GSCrmInfo.Application.Navbar;$('[data-type=\"NavbarToggler\"]').attr(\"collapsed\")&&e.Dispose(event)}).ready(()=>{if(null==GSCrmInfo.Application.prototype){let e=new G(\"GSCrm\");GSCrmInfo.Application=e}if(null==sessionStorage.getItem(\"GSCrmApplicationName\"))GSCrmInfo.Application.Initialize().catch(e=>console.log(e));else{GSCrmInfo.ApplicationInfo=JSON.parse(sessionStorage.getItem(\"GSCrmApplicationInfo\")),(new o).RenderApplication();let e=document.location.pathname.split(\"/\")[1];if(null!=e){let t=e.split(\"%20\").join(\" \").split(\"/\").join(\"\");\"Home Screen\"!=t&&GSCrmInfo.Application.CommonRequests.GetApplicationInfo().catch(e=>console.log(e)).then(e=>{if(GSCrmInfo.ApplicationInfo=e,(new o).RenderApplication(),!Object.is(e.CurrentScreen,null)){t=e.CurrentScreen.Name;let a=null==e.CurrentView?null:e.CurrentView.Name,n=new GSCrmInfo.Application.Screen(t),o={NewScreenName:t,NewViewName:a};n.Initialize(o).catch(e=>console.log(e))}})}}}),$(document).on(\"click\",'[data-type=\"SelectArea\"]',e=>e.stopPropagation()),$(document).on(\"click\",'[data-type=\"PickList\"]',e=>e.stopPropagation()),$(document).on(\"click\",\".p-modal-close\",e=>{let t=GSCrmInfo.CurrentElementsInfo;t.PopupApplet.Dispose(e,!0),GSCrmInfo.Application.CommonAction.DisposePopupApplet(\"ClosePopup\",t.Record.Id,\"ClosePopup\")}),$(document).on(\"click\",'[data-type=\"NavbarToggler\"]',e=>{let t=new GSCrmInfo.Application.Navbar;\"false\"==$('[data-type=\"NavbarToggler\"]').attr(\"collapsed\")&&t.Initialize(e)}),$(window).on(\"resize\",()=>{$(\".all-popup\").hasClass(\"d-none\")||(window.innerWidth<992?$(\"html\").css(\"overflow\",\"hidden\"):$(\"html\").css(\"overflow\",\"auto\"))})}]);","extractedComments":[]}